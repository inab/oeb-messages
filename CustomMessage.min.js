export default class CustomMessage extends HTMLElement{constructor(){super(),this.url=null,this.borderColor="#c6d8e9",this.backgroundColor="#f8f8f8",this.textColor="#000000"}async createMessage(){let e=document.createElement("div");e.style.border=`1px solid ${this.borderColor}`,e.style.backgroundColor=this.backgroundColor,e.style.color=this.textColor,e.style.padding="10px 20px";let t=await this.getJSON(this.url).then((e=>{if(e&&""!==e){let t=JSON.parse(e);if(t.isActive){let e="";t.icon&&""!==t.icon&&(e+=t.icon),e+=t.message;let r=new Date(t.start_date+"Z"),s=this.getDateOrdinals(r.getDate()),n=new Date(t.end_date+"Z"),a=this.getDateOrdinals(n.getDate()),o=n.toLocaleString("en-EN",{month:"long"});return e=e.replace("##start_date",s),e=e.replace("##end_date",a),e=e.replace("##end_month",o),e}return""}return""}));return""!=t?(e.innerHTML=t,e.outerHTML):""}async getJSON(e){var t=new XMLHttpRequest;t.open("GET",e,!1);try{return t.send(),t.responseText}catch(t){return console.log("Error fetching "+e),""}}getDateOrdinals(e){if(e>3&&e<21)return`${e}th`;switch(e%10){case 1:return`${e}st`;case 2:return`${e}nd`;case 3:return`${e}rd`;default:return`${e}th`}}connectedCallback(){this.url=this.getAttribute("url"),this.createMessage().then((e=>{this.innerHTML=e}))}}customElements.define("custom-message",CustomMessage);